{
  // Dev container identity (shown in VS Code)
  "name": "Dev Swiss Army Container",

  // Docker Compose integration
  "dockerComposeFile": "../docker-compose.yml",
  "service": "helvetia",

  // Workspace root inside the container
  "workspaceFolder": "/workspaces/",

  // Always use the non-root user provided by the base image
  "remoteUser": "vscode",

  // --------------------------------------------------
  // Optional Dev Container Features
  // Enable only when explicitly required
  // --------------------------------------------------

  "features": {
    "ghcr.io/devcontainers/features/python:1": { "version": "3.11" }
  },

  // --------------------------------------------------
  // Optional port forwarding (development only)
  // Container ports must still be exposed via docker-compose
  // --------------------------------------------------
  /*
  "forwardPorts": [
    3000,
    8000,
    8080
  ],
  */

  // --------------------------------------------------
  // VS Code configuration scoped to this container
  // --------------------------------------------------
  "customizations": {
    "vscode": {
      "settings": {
        // Format files on save
        "editor.formatOnSave": true,

        // Use Docker-specific formatter for Dockerfiles
        "[dockerfile]": {
          "editor.defaultFormatter": "ms-azuretools.vscode-containers"
        },

        // Reduce noise from unicode warnings
        "editor.unicodeHighlight.ambiguousCharacters": false,

        // Copilot quality-of-life improvement
        "github.copilot.nextEditSuggestions.enabled": true
      },

      "extensions": [
        // Core tooling
        "esbenp.prettier-vscode",
        "ms-azuretools.vscode-docker",
        "ms-python.python",
        "ms-python.vscode-pylance",
        "redhat.vscode-yaml",
        "redhat.ansible",

        // AI assistance
        "openai.chatgpt",
        "github.copilot",
        "github.copilot-chat"
      ]
    }
  },

  // Optional hook executed once after container creation
  "postCreateCommand": "python -m pip install --upgrade pip && pip install -r ansible/requirements.txt"
}
